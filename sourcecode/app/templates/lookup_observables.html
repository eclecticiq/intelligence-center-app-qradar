<!DOCTYPE html>
<html class="chrome" lang="en">
 <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <link rel="stylesheet" type="text/css" href="./static/styles.css">
<h1>EclecticIQ Lookup Result</h1>
 <div class="body table-responsive">
                            <div id="lookup_observables" class="lds-dual-ring hidden overlay"></div>
                            <table class="table table-striped tableChart chart1Top"  style="width: 100%; color: black;  border: 1px solid #dddddd;
    height: 30px;" id="chart1">
                                <thead>
                                    <tr role="row" style="background-color: #42b598;">
                                        <th class="sorting_asc" tabindex="0" scope="col"
                                            rowspan="1" colspan="1" aria-sort="ascending"
                                             style="width: 700px;">
                                            Title</th>
                                        <th class="sorting_asc" tabindex="0" scope="col"
                                            rowspan="1" colspan="1" aria-sort="ascending"
                                             style="width: 700px;">
                                            Description</th>
                                             <th class="sorting_asc" tabindex="0" scope="col"
                                            rowspan="1" colspan="1" aria-sort="ascending"
                                             style="width: 700px;">
                                            Threat Start</th>
                                             <th class="sorting_asc" tabindex="0" scope="col"
                                            rowspan="1" colspan="1" aria-sort="ascending"
                                             style="width: 700px;">
                                            Tags</th>
                                             <th class="sorting_asc" tabindex="0" scope="col"
                                            rowspan="1" colspan="1" aria-sort="ascending"
                                             style="width: 700px;">
                                            Source Name</th>
                                             <th class="sorting_asc" tabindex="0" scope="col"
                                            rowspan="1" colspan="1" aria-sort="ascending"
                                             style="width: 700px;">
                                            Observables</th>
                                    </tr>
                                </thead>
                                <tbody id="lookup_observables">

                                    {% for item in context%}
                                    <tr>
                                         <td style="border: 1px solid #dddddd;">{{item.entity_title}}</td>
                                         <td style="border: 1px solid #dddddd;">{{item.description}}</td>
                                         <td style="border: 1px solid #dddddd;">{{item.created_at}}</td>
                                         <td style="border: 1px solid #dddddd;">
                                            {% for tag in item.tags_list %}
                              "{{ tag }}"
                          {% endfor %}



                                         </td>
                                         <td style="border: 1px solid #dddddd;">{{item.source_name}}</td>
                                          <td style="border: 1px solid #dddddd;">
                                          <table class="table table-striped tableChart"  style="width: 100%; color: black;  border: 1px solid #dddddd; height: 10px;" id="chart2">
                                          <thead>
                                            <tr role="row" style="background-color: #42b598;">
                                            <th class="sorting_asc" tabinditemx="0" scope="col"
                                                rowspan="1" colspan="1" aria-sort="ascending"
                                                 style="width: 100px;">
                                                Kind</th>
                                            <th class="sorting_asc" tabindex="0" scope="col"
                                                rowspan="1" colspan="1" aria-sort="ascending"
                                                 style="width: 100px;">
                                                Value</th>
                                                 <th class="sorting_asc" tabindex="0" scope="col"
                                                rowspan="1" colspan="1" aria-sort="ascending"
                                                 style="width: 100px;">
                                                Maliciousness</th>
                                                </tr>
                                            </thead>

                                            <tbody id="observables">

                                                {% for obs_data in item.observables_list %}
                                                <tr><td >
                                                    {{obs_data.type}}
                                                </td>
                                                <td >
                                                    {{obs_data.value}}
                                                </td>

                                                <td>  {{obs_data.maliciousness}}</td>
                                                </tr>
                                                {% endfor %}

                                            </tbody>
                                            </table>
                                        </td>
                                                  </tr>
                                                
                                                {% endfor %}
                            </tbody>

                         </table>
                        </div>
                        <div class="sumbitButton">
                             <button type="button" onclick="location.href = 'create_sighting?sighting_value={{ search }}';" style="text-align: -webkit-center;font-size: 12px;margin-left: 50px;">Create Sighting</button>

        </div>



{% block script %}
<script src="./static/js/lib/jquery-3.5.1.min.js" type="text/javascript" ></script>
         <script src="./static/js/lib/jquery.dataTables.min.js"></script>
         <script src="./static/js/lib/jquery.slimscroll.js"></script>
 <script>

 $(document).ready(function()
{

    $(function(){
    $.getJSON('./lookup_observables', function(data) {
        var observables=data;

        })
    });

});

 </script>
 {% endblock %}
 </html>